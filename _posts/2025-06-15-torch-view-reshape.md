---
layout: post
title:  "[PyTorch] view() vs. reshape() ë¹„êµ"
date:   2025-06-15 10:00:00 +0900
categories: [PyTorch]
tags: [PyTorch, reshape(),view(), commit, repository]
comments: true     # ëŒ“ê¸€ ê¸°ëŠ¥ ì‚¬ìš© (ì˜µì…˜)

---


# ğŸŸ£ Intro
- pytorchë¥¼ ì‚¬ìš©í•˜ë‹¤ë³´ë©´ tensorì˜ shapeì„ ë°”ê¿”ì•¼í•˜ëŠ” ì‘ì—…ì´ ë§¤ìš° ë¹ˆë²ˆí•˜ë‹¤. ì™œëƒë©´ ëª¨ë¸ì— forwardë¥¼ í•˜ë”ë¼ë„ 2ì°¨ì› ë°ì´í„°ì˜ ê²½ìš°ëŠ” (B,C,W,H)ì²˜ëŸ¼ ì°¨ì›ì„ ì„¤ì •í•´ì¤˜ì•¼ ê° ë ˆì´ì–´ì—ì„œ í•™ìŠµì´ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì´ë‹¤. ê·¸ëŸ´ë•Œ ë§ì´ ì“°ëŠ” torchì˜ ë©”ì„œë“œê°€ `reshape()`ê³¼ `view()`ì´ë‹¤.


#### 
```
a = torch.randn(3, 2, 4)
b = a.reshape(-1)  # reshape() ë©”ì„œë“œë¥¼ ì¨ì„œ 1ì°¨ì›ìœ¼ë¡œ ë§Œë“¦
b[0] = 99999

a  # aì—ë„ ì˜í–¥ì„ ì¤€ë‹¤

a = torch.randn(3, 2, 4)
b = a.view(-1)  # reshape() ë©”ì„œë“œë¥¼ ì¨ì„œ 1ì°¨ì›ìœ¼ë¡œ ë§Œë“¦
b[0] = 99999

a  # aì—ë„ ì˜í–¥ì„ ì¤€ë‹¤



#### âšª ê¹ê¹í•œ ì›ì¹™ì£¼ì˜ì (`view()`) vs. ìœµí†µì„± ìˆëŠ” í•´ê²°ì‚¬ (`reshape()`)

âŒ No.
```py
import torch
# 1. ì¼ë°˜ì ì¸ ìƒí™©: ë‘˜ ë‹¤ ë©”ëª¨ë¦¬ë¥¼ ê³µìœ í•œë‹¤.
x = torch.arange(1, 7) # tensor([1, 2, 3, 4, 5, 6])
print(f"xëŠ” ì—°ì†ì ì¸ê°€? {x.is_contiguous()}")

# x_viewì™€ x_reshape ëª¨ë‘ xì™€ ê°™ì€ ë©”ëª¨ë¦¬ ê³µê°„ì„ ê°€ë¦¬í‚¨ë‹¤.
x_view = x.view(2, 3)
x_reshape = x.reshape(2, 3)

# x_viewì˜ ê°’ì„ ë°”ê¾¸ë©´...
x_view[0, 0] = 99

# ì›ë³¸ xì™€ x_reshapeì˜ ê°’ë„ ëª¨ë‘ ë°”ë€ë‹¤!
print(f"ì›ë³¸ x: \n{x}")
print(f"x_reshape: \n{x_reshape}")
# ì›ë³¸ x:
# tensor([99,  2,  3,  4,  5,  6])
# x_reshape:
# tensor([[99,  2,  3],
#         [ 4,  5,  6]])
print("-" * 20)


# 2. ë¬¸ì œê°€ ë˜ëŠ” ìƒí™©: ë©”ëª¨ë¦¬ê°€ ì—°ì†ì ì´ì§€ ì•Šì„ ë•Œ
y = torch.arange(1, 7).reshape(2, 3)
y_transposed = y.T # .TëŠ” .transpose(0, 1)ì™€ ê°™ìŒ. ëª¨ì–‘ì€ (3,2)ê°€ ë¨
print(f"y_transposedëŠ” ì—°ì†ì ì¸ê°€? {y_transposed.is_contiguous()}")
# y_transposedëŠ” ì—°ì†ì ì¸ê°€? False  <-- ë°”ë¡œ ì´ ë•Œ!

# 2-1. ì›ì¹™ì£¼ì˜ì view()ëŠ” ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚¨ë‹¤!
try:
    y_view = y_transposed.view(2, 3)
except RuntimeError as e:
    print(f"view() ì—ëŸ¬ ë°œìƒ: {e}")
# view() ì—ëŸ¬ ë°œìƒ: view size is not compatible with input tensor's size and stride...
# '...Use .reshape() or .contiguous().' ë¼ê³  ì¹œì ˆí•˜ê²Œ ì•Œë ¤ì£¼ë„¤!

# 2-2. í•´ê²°ì‚¬ reshape()ëŠ” ì¡°ìš©íˆ ë³µì‚¬ë³¸ì„ ë§Œë“¤ì–´ ì²˜ë¦¬í•œë‹¤.
y_reshape = y_transposed.reshape(2, 3)

# y_reshapeì˜ ê°’ì„ ë°”ê¿”ë„...
y_reshape[0, 0] = 777

# ì›ë³¸ y_transposedì—ëŠ” ì•„ë¬´ëŸ° ì˜í–¥ì´ ì—†ë‹¤! (ë³µì‚¬ë³¸ì´ë‹ˆê¹Œ)
print(f"\ny_reshape: \n{y_reshape}")
print(f"ì›ë³¸ y_transposed: \n{y_transposed}")
# y_reshape:
# tensor([[777,   2,   4],
#         [  3,   5,   6]])
# ì›ë³¸ y_transposed:
# tensor([[1, 4],
#         [2, 5],
#         [3, 6]])
```

 #### âšª ê·¸ë˜ì„œ ë­˜ ì¨ì•¼ í• ê¹Œ?
ì¼ë°˜ì ìœ¼ë¡œëŠ” ê·¸ëƒ¥ `reshape()`ì„ ì“°ëŠ” ê²Œ í¸í•˜ê³  ì•ˆì „.
ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ìš°ë¦¬ê°€ ì›í•˜ëŠ” ëŒ€ë¡œ ë™ì‘í•˜ê³ , êµ³ì´ ë©”ëª¨ë¦¬ ì—°ì†ì„±ê¹Œì§€ ì‹ ê²½ ì“°ì§€ ì•Šì•„ë„ ë˜ë‹ˆê¹Œ.

`view()`ëŠ” ì´ëŸ´ ë•Œ ì‚¬ìš©.
ë‚´ ì½”ë“œì—ì„œ **"ì—¬ê¸°ëŠ” ë°˜ë“œì‹œ ë©”ëª¨ë¦¬ ê³µìœ ê°€ ì¼ì–´ë‚˜ì•¼ í•˜ê³ , ë¶ˆí•„ìš”í•œ ë³µì‚¬ê°€ ìƒê¸°ë©´ ì•ˆ ë˜ëŠ” ì•„ì£¼ ì¤‘ìš”í•œ ë¶€ë¶„ì´ì•¼!"**ë¼ê³  ëª…ì‹œí•˜ê³  ì‹¶ì„ ë•Œ. ë˜ëŠ” viewê°€ ë  ê±°ë¼ê³  100% í™•ì‹ í•  ë•Œ ì‚¬ìš©í•˜ë©´, **ì˜ë„ì¹˜ ì•Šì€ ë³µì‚¬ë¥¼ ë§‰ëŠ” ì•ˆì „ì¥ì¹˜**ê°€ ë  ìˆ˜ ìˆìŒ.
