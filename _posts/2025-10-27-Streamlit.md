---
layout: post
title:  "16-(1) Streamlitì„ ì‚¬ìš©í•´ì„œ AI ëª¨ë¸ì„ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì— í†µí•©í•˜ë ¤ë©´ ëª¨ë¸ ë¡œë“œ, ì‚¬ìš©ìž ìž…ë ¥, ê²°ê³¼ ì¶œë ¥ì˜ ë‹¨ê³„ë¥¼ ê±°ì³ì•¼í•©ë‹ˆë‹¤. ê°ê°ì˜ ë‹¨ê³„ì— ëŒ€í•´ ì„¤ëª…í•´ì£¼ì„¸ìš”."
date:   2025-10-27 00:00:00 +0900
categories: [Streamlit]
tags: [Quantization, Streamlit, Docker, Deep Learning, AI]
comments: true     # ëŒ“ê¸€ ê¸°ëŠ¥ ì‚¬ìš© (ì˜µì…˜)
image:
    path: https://blog.zarathu.com/posts/2023-02-01-streamlit/logo.jpeg
description: "ðŸŸ¢ íŒŒì´ì¬ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ê³µìœ  ê°€ëŠ¥í•œ ëŒ€í™”í˜• ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ Streamlitì— ëŒ€í•´ ì•Œì•„ë³´ìž"

---
## ðŸŸ¢ Streamlitì´ëž€?

**Streamlit**ì€ ë°ì´í„° ê³¼í•™ìžë‚˜ AI ì—”ì§€ë‹ˆì–´ê°€ **Python ìŠ¤í¬ë¦½íŠ¸**ë¥¼ **ê³µìœ  ê°€ëŠ¥í•œ ëŒ€í™”í˜• ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜**ìœ¼ë¡œ ë§¤ìš° ë¹ ë¥´ê³  ì‰½ê²Œ ë§Œë“¤ ìˆ˜ ìžˆê²Œ í•´ì£¼ëŠ” ì˜¤í”ˆì†ŒìŠ¤ í”„ë ˆìž„ì›Œí¬ì•¼.


**í•µì‹¬ ê°œë…:**ì„ ê°„ëžµí•˜ê²Œ ì„¤ëª…í•˜ë©´, 

1.  **Pythonìœ¼ë¡œë§Œ êµ¬í˜„**: HTML, CSS, JavaScript ê°™ì€ ì›¹ ê¸°ìˆ ì„ ê±°ì˜ ëª°ë¼ë„ ë¼. ê·¸ëƒ¥ í‰ì†Œ ì“°ë˜ Python ì½”ë“œì— `st.write()`, `st.slider()` ê°™ì€ Streamlit í•¨ìˆ˜ ëª‡ ê°œë§Œ ì¶”ê°€í•˜ë©´ ëœë‹¤.
2.  **ë°ì´í„° ì•± íŠ¹í™”**: ë³µìž¡í•œ ì›¹ì‚¬ì´íŠ¸ë³´ë‹¤ëŠ” ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ ë°ëª¨, ë°ì´í„° ëŒ€ì‹œë³´ë“œ, ë¦¬í¬íŠ¸ ê³µìœ  ë“± 'ë°ì´í„°'ë¥¼ ë³´ì—¬ì£¼ê³  'ìƒí˜¸ìž‘ìš©'í•˜ëŠ” ë° ìµœì í™”ë˜ì–´ ìžˆë‹¤.
3.  **ì¦‰ê°ì ì¸ ë°˜ì‘ì„±**: ì½”ë“œë¥¼ ìˆ˜ì •í•˜ê³  ì €ìž¥í•˜ë©´ ì›¹ ì•±ì´ ê±°ì˜ ì‹¤ì‹œê°„ìœ¼ë¡œ ìžë™ ì—…ë°ì´íŠ¸ëœë‹¤. ê°œë°œ ì†ë„ê°€ ì—„ì²­ë‚˜ê²Œ ë¹ ë¦„!

ê°„ë‹¨ížˆ ë§í•´, **"Jupyter Notebookì´ë‚˜ Python ìŠ¤í¬ë¦½íŠ¸ë¡œë§Œ ë³´ë˜ ë¶„ì„ ê²°ê³¼ë‚˜ AI ëª¨ë¸ì„, í´ë¦­ ê°€ëŠ¥í•œ ë²„íŠ¼ê³¼ ìŠ¬ë¼ì´ë”ê°€ ìžˆëŠ” ë©‹ì§„ ì›¹íŽ˜ì´ì§€ë¡œ ìˆœì‹ê°„ì— ë°”ê¿”ì£¼ëŠ” ë„êµ¬"**ë¼ê³  ìƒê°í•˜ë©´ ë˜ê² ë‹¤.

![ìŠ¤íŠ¸ë¦¼ë¦¿](https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRCht8arD7Xl4_JCHmOVSLk-UGQuT2UzjYIGQ&s)


---


## ðŸŸ¢ Streamlitì˜ ê° ë‹¨ê³„ë³„ ì„¤ëª…


#### âšª 1. ëª¨ë¸ ë¡œë“œ (Model Load)

ê°€ìž¥ ë¨¼ì €, í›ˆë ¨ëœ AI ëª¨ë¸ì„ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë©”ëª¨ë¦¬ë¡œ ê°€ì ¸ì™€ì•¼ í•©ë‹ˆë‹¤.

**í•µì‹¬ì€ ìºì‹±(Caching)ìž…ë‹ˆë‹¤.** AI ëª¨ë¸ì€ í¬ê¸°ê°€ í¬ê³  ë¡œë“œí•˜ëŠ” ë° ì‹œê°„ì´ ì˜¤ëž˜ ê±¸ë¦´ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì‚¬ìš©ìžê°€ ì›¹ ì•±ì—ì„œ ë²„íŠ¼ì„ ëˆ„ë¥´ê±°ë‚˜ ìŠ¬ë¼ì´ë”ë¥¼ ì¡°ìž‘í•  ë•Œë§ˆë‹¤ ëª¨ë¸ì„ ìƒˆë¡œ ë¡œë“œí•œë‹¤ë©´ ì•±ì´ ë§¤ìš° ëŠë ¤ì§ˆ ê²ƒìž…ë‹ˆë‹¤.

Streamlitì€ ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ê°•ë ¥í•œ ìºì‹œ ë°ì½”ë ˆì´í„°ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ëª¨ë¸ê³¼ ê°™ì´ í•œ ë²ˆ ë¡œë“œí•œ í›„ ë³€ê²½ë˜ì§€ ì•ŠëŠ” 'ë¦¬ì†ŒìŠ¤'ë¥¼ ë¡œë“œí•  ë•ŒëŠ” \*\*`@st.cache_resource`\*\*ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ê°€ìž¥ ì¢‹ìŠµë‹ˆë‹¤.

  * ëª¨ë¸ ë¡œë“œ ì „ìš© í•¨ìˆ˜ë¥¼ ë§Œë“­ë‹ˆë‹¤.
  * í•¨ìˆ˜ ìœ„ì— `@st.cache_resource` ë°ì½”ë ˆì´í„°ë¥¼ ë¶™ìž…ë‹ˆë‹¤.
  * ì´ì œ ì´ í•¨ìˆ˜ëŠ” ì•±ì´ ì²˜ìŒ ì‹¤í–‰ë  ë•Œë§Œ ëª¨ë¸ì„ ë¡œë“œí•˜ê³ , ê·¸ ì´í›„ì—ëŠ” ìºì‹œëœ ëª¨ë¸ì„ ì¦‰ì‹œ ë°˜í™˜í•©ë‹ˆë‹¤.

**ì˜ˆì‹œ (PyTorch ëª¨ë¸ ë¡œë“œ):**

```python
import streamlit as st
import torch
from your_model_file import YourModelClass # ëª¨ë¸ í´ëž˜ìŠ¤ê°€ ì •ì˜ëœ íŒŒì¼

# @st.cache_resourceë¥¼ ì‚¬ìš©í•´ ëª¨ë¸ ë¡œë“œ í•¨ìˆ˜ë¥¼ ì •ì˜
@st.cache_resource
def load_model(model_path):
    """
    ì§€ì •ëœ ê²½ë¡œì—ì„œ í›ˆë ¨ëœ PyTorch ëª¨ë¸ì„ ë¡œë“œí•©ë‹ˆë‹¤.
    """
    model = YourModelClass() # ëª¨ë¸ ì•„í‚¤í…ì²˜ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
    model.load_state_dict(torch.load(model_path, map_location=torch.device('cpu')))
    model.eval() # ì¶”ë¡  ëª¨ë“œë¡œ ì„¤ì •
    print(f"Model loaded from {model_path}") # í„°ë¯¸ë„ì— ë¡œê·¸ê°€ í•œ ë²ˆë§Œ ì°ížˆëŠ” ê²ƒì„ í™•ì¸
    return model

# ë©”ì¸ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ëª¨ë¸ ë¡œë“œ
# ì´ í•¨ìˆ˜ëŠ” ì•± ì‹¤í–‰ ì‹œ í•œ ë²ˆë§Œ ì‹¤í–‰ë©ë‹ˆë‹¤.
model = load_model("models/best_model.pth")
```

-----

## 2\. ì‚¬ìš©ìž ìž…ë ¥ (User Input)

ëª¨ë¸ì´ ì¶”ë¡ (prediction)ì— ì‚¬ìš©í•  ë°ì´í„°ë¥¼ ì‚¬ìš©ìžë¡œë¶€í„° ë°›ì•„ì•¼ í•©ë‹ˆë‹¤. Streamlitì€ ë‹¤ì–‘í•œ ìœ„ì ¯(widgets)ì„ ì œê³µí•˜ì—¬ ì´ ê³¼ì •ì„ ì‰½ê²Œ ë§Œë“­ë‹ˆë‹¤.

AI ëª¨ë¸ì˜ ì¢…ë¥˜ì— ë”°ë¼ ì‚¬ìš©í•˜ëŠ” ìœ„ì ¯ì´ ë‹¬ë¼ì§‘ë‹ˆë‹¤.

  * **ì»´í“¨í„° ë¹„ì „ (CV):**
      * **`st.file_uploader`**: ì‚¬ìš©ìžê°€ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•  ìˆ˜ ìžˆê²Œ í•©ë‹ˆë‹¤. (e.g., `type=['jpg', 'png']`)
      * **`st.camera_input`**: ì›¹ìº ì„ ì‚¬ìš©í•´ ì‹¤ì‹œê°„ìœ¼ë¡œ ì‚¬ì§„ì„ ì°ì–´ ìž…ë ¥ë°›ì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
  * **ìžì—°ì–´ ì²˜ë¦¬ (NLP):**
      * **`st.text_input`**: í•œ ì¤„ì˜ í…ìŠ¤íŠ¸(ì˜ˆ: ê²€ìƒ‰ì–´)ë¥¼ ìž…ë ¥ë°›ìŠµë‹ˆë‹¤.
      * **`st.text_area`**: ì—¬ëŸ¬ ì¤„ì˜ í…ìŠ¤íŠ¸(ì˜ˆ: ìš”ì•½í•  ë¬¸ë‹¨)ë¥¼ ìž…ë ¥ë°›ìŠµë‹ˆë‹¤.
  * **ì •í˜• ë°ì´í„° (Tabular Data):**
      * **`st.slider`**: íŠ¹ì • ë²”ìœ„ ë‚´ì˜ ìˆ«ìž ê°’ì„ ìž…ë ¥ë°›ìŠµë‹ˆë‹¤. (ì˜ˆ: ì£¼íƒ ê°€ê²© ì˜ˆì¸¡ ì‹œ 'ë°© ê°œìˆ˜')
      * **`st.number_input`**: ì •ìˆ˜ ë˜ëŠ” ì‹¤ìˆ˜ë¥¼ ìž…ë ¥ë°›ìŠµë‹ˆë‹¤.
      * **`st.selectbox`**: ë“œë¡­ë‹¤ìš´ ë©”ë‰´ì—ì„œ ì¹´í…Œê³ ë¦¬í˜• ë°ì´í„°ë¥¼ ì„ íƒë°›ìŠµë‹ˆë‹¤.

**ì˜ˆì‹œ (ì´ë¯¸ì§€ íŒŒì¼ ì—…ë¡œë“œ):**

```python
st.title("AI ëª¨ë¸ ë°ëª¨")

# 1ë‹¨ê³„ì—ì„œ ë¡œë“œí•œ ëª¨ë¸ì„ ì—¬ê¸°ì„œ ì‚¬ìš©
# model = load_model(...) 

# 2ë‹¨ê³„: ì‚¬ìš©ìž ìž…ë ¥ ë°›ê¸°
st.header("ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”")
uploaded_file = st.file_uploader("ë¶„ì„í•  ì´ë¯¸ì§€ë¥¼ ì„ íƒí•˜ì„¸ìš”.", type=["jpg", "png", "jpeg"])

if uploaded_file is not None:
    # ì—…ë¡œë“œëœ ì´ë¯¸ì§€ë¥¼ í™”ë©´ì— í‘œì‹œ
    st.image(uploaded_file, caption="ì—…ë¡œë“œëœ ì´ë¯¸ì§€", use_column_width=True)
    st.write("") # ì¤„ë°”ê¿ˆ
```

-----

## 3\. ê²°ê³¼ ì¶œë ¥ (Result Output)

ì‚¬ìš©ìž ìž…ë ¥ì„ ë°›ì•„ ëª¨ë¸ë¡œ ì²˜ë¦¬(ì¶”ë¡ )í•œ ë’¤, ê·¸ ê²°ê³¼ë¥¼ ì‚¬ìš©ìžì—ê²Œ ë³´ì—¬ì£¼ëŠ” ë‹¨ê³„ìž…ë‹ˆë‹¤.

ì´ ë‹¨ê³„ëŠ” í¬ê²Œ **(1) ë°ì´í„° ì „ì²˜ë¦¬**, **(2) ëª¨ë¸ ì¶”ë¡ **, **(3) ê²°ê³¼ í›„ì²˜ë¦¬ ë° ì¶œë ¥**ìœ¼ë¡œ ë‚˜ë‰©ë‹ˆë‹¤.

ë³´í†µ ì‚¬ìš©ìžê°€ "ì˜ˆì¸¡" ë˜ëŠ” "ì‹¤í–‰" ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ ì´ ê³¼ì •ì´ ì‹¤í–‰ë˜ë„ë¡ \*\*`st.button`\*\*ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

  * **`st.write()`**: í…ìŠ¤íŠ¸, ìˆ«ìž, ë°ì´í„°í”„ë ˆìž„ ë“± ëŒ€ë¶€ë¶„ì˜ ê²ƒì„ ì¶œë ¥í•˜ëŠ” ë§ŒëŠ¥ ëª…ë ¹ì–´ìž…ë‹ˆë‹¤.
  * **`st.image()`**: ê²°ê³¼ ì´ë¯¸ì§€(ì˜ˆ: ë°”ìš´ë”© ë°•ìŠ¤ê°€ ê·¸ë ¤ì§„ ì´ë¯¸ì§€)ë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤.
  * **`st.success()` / `st.error()` / `st.info()`**: íŠ¹ì • í˜•ì‹ì˜ ë©”ì‹œì§€ ë°•ìŠ¤ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.
  * **`st.bar_chart()`**: ì˜ˆì¸¡ í™•ë¥  ë“±ì„ ë§‰ëŒ€ê·¸ëž˜í”„ë¡œ ì‹œê°í™”í•©ë‹ˆë‹¤.
  * **`st.spinner()`**: ëª¨ë¸ì´ ì¶”ë¡ ì„ ìˆ˜í–‰í•˜ëŠ” ë™ì•ˆ "ì²˜ë¦¬ ì¤‘..."ê³¼ ê°™ì€ ë¡œë”© ìŠ¤í”¼ë„ˆë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.

**ì˜ˆì‹œ (ë²„íŠ¼ í´ë¦­ ì‹œ ì˜ˆì¸¡ ë° ê²°ê³¼ ì¶œë ¥):**

```python
# ... (ëª¨ë¸ ë¡œë“œ ë° íŒŒì¼ ì—…ë¡œë“œ ì½”ë“œ ì´í›„) ...

# ì˜ˆì¸¡ ìˆ˜í–‰ì„ ìœ„í•œ ë²„íŠ¼
if st.button("ê²°ê³¼ ì˜ˆì¸¡í•˜ê¸°"):
    if uploaded_file is not None:
        # 3-1. ë°ì´í„° ì „ì²˜ë¦¬ (ì˜ˆ: PIL ì´ë¯¸ì§€ -> Tensor)
        from PIL import Image
        import your_transforms # ì‚¬ìš©ìžê°€ ì •ì˜í•œ ì „ì²˜ë¦¬ í•¨ìˆ˜

        image = Image.open(uploaded_file).convert("RGB")
        input_tensor = your_transforms.preprocess(image) # ëª¨ë¸ì´ ìš”êµ¬í•˜ëŠ” í˜•ì‹ìœ¼ë¡œ ë³€í™˜

        # 3-2. ëª¨ë¸ ì¶”ë¡  (ë¡œë”© ìŠ¤í”¼ë„ˆì™€ í•¨ê»˜)
        with st.spinner("AIê°€ ì´ë¯¸ì§€ë¥¼ ë¶„ì„ ì¤‘ìž…ë‹ˆë‹¤... ðŸ§ "):
            with torch.no_grad():
                output = model(input_tensor.unsqueeze(0)) # ë°°ì¹˜ ì°¨ì› ì¶”ê°€

        # 3-3. ê²°ê³¼ í›„ì²˜ë¦¬ ë° ì¶œë ¥
        # ì˜ˆ: output í…ì„œë¥¼ ì‚¬ëžŒì´ ì½ì„ ìˆ˜ ìžˆëŠ” í…ìŠ¤íŠ¸ë¡œ ë³€í™˜
        prediction_text = your_transforms.postprocess(output) 

        st.subheader("ëª¨ë¸ ì˜ˆì¸¡ ê²°ê³¼")
        st.success(f"ì˜ˆì¸¡ëœ í´ëž˜ìŠ¤: **{prediction_text}**")
        
        # (ì„ íƒ) ê²°ê³¼ ì´ë¯¸ì§€ë‚˜ ì°¨íŠ¸ ì¶œë ¥
        # st.image(output_image)
        # st.bar_chart(probabilities)

    else:
        st.warning("ë¨¼ì € ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.")
```
---

## ðŸŸ¢ ë§ˆì¹˜ë©°

Streamlitì€ Python ì½”ë“œë§Œìœ¼ë¡œ ì›¹ ì•±(Web App) ì„ ì•„ì£¼ ì‰½ê²Œ ë§Œë“¤ ìˆ˜ ìžˆê²Œ í•´ì£¼ëŠ” ì˜¤í”ˆì†ŒìŠ¤ í”„ë ˆìž„ì›Œí¬ì´ë‹¤.

ë³´í†µ ì›¹ ì•±ì„ ë§Œë“¤ë ¤ë©´ HTML, CSS, JavaScriptë¥¼ ë‹¤ë¤„ì•¼ í•˜ì§€ë§Œ, Streamlitì€ ê·¸ëŸ´ í•„ìš” ì—†ì´ Python ì½”ë“œë§Œìœ¼ë¡œ ë°ì´í„° ì‹œê°í™”ë‚˜ ëª¨ë¸ ë°ëª¨ë¥¼ ì›¹ íŽ˜ì´ì§€ì²˜ëŸ¼ ë³´ì—¬ì¤„ ìˆ˜ ìžˆë‹¤ëŠ” ìž¥ì ì´ ìžˆìœ¼ë‹ˆ ì›¹ê°œë°œìžê°€ ì•„ë‹ˆë”ë¼ë„ í™œìš©ë„ê°€ ë†’ì„ê²ƒ ê°™ë‹¤.

- ëª©ì : ë°ì´í„°ë¥¼ ë³´ê¸° ì‰½ê²Œ ì‹œê°í™”í•˜ê³ , ML ëª¨ë¸ì„ ì›¹ìœ¼ë¡œ ë³´ì—¬ì£¼ê¸° ìœ„í•´
- ì–¸ì–´: 100% Python
- ìž¥ì : ë¹ ë¦„, ì‰½ë‹¤, ì§ê´€ì ì´ë‹¤
- ë¹„ìŠ·í•œ íˆ´: Dash, Gradio, Flask (í•˜ì§€ë§Œ Streamlitì´ ì œì¼ ì‰¬ì›€!)



## ðŸŸ¢ ì˜ˆì‹œ ë‹µì•ˆ (ì½”ë“œìž‡ ì œê³µ)


>.